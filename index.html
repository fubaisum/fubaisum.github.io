

<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Fbsum&#39;s Blog</title>
  <meta name="author" content="fbsum">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Fbsum&#39;s Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Fbsum&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Fbsum&#39;s Blog</a></h1>
  <h2><a href="/">Don&#39;t retry yourself.</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-09-01T15:20:24.000Z"><a href="/2017/09/01/kotlin-dev-plugin-1/">2017-09-01</a></time>
      
      
  
    <h1 class="title"><a href="/2017/09/01/kotlin-dev-plugin-1/">Kotlin 开发 Intellij Plugin —— Hello World</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="参考"><a href="#参考" class="headerlink" title="参考:"></a>参考:</h3><ul>
<li><p><a href="http://www.jetbrains.org/intellij/sdk/docs/tutorials/build_system/prerequisites.html#add-gradle-support-from-scratch" target="_blank" rel="external">项目添加 Gradle 支持</a></p>
</li>
<li><p><a href="https://github.com/JetBrains/gradle-intellij-plugin" target="_blank" rel="external">JetBrains/gradle-intellij-plugin 项目</a></p>
</li>
<li><p><a href="https://moxun.me/archives/28" target="_blank" rel="external">✨ 快速入门教程</a></p>
</li>
</ul>
<h3 id="配置开发环境"><a href="#配置开发环境" class="headerlink" title="配置开发环境"></a>配置开发环境</h3><ul>
<li><p><a href="http://www.jetbrains.org/intellij/sdk/docs/basics/getting_started/setting_up_environment.html" target="_blank" rel="external">获取社区版 IntelliJ IDEA 的源码</a></p>
</li>
<li><p>直接使用安装的 IntelliJ IDEA／Android Studio 环境</p>
</li>
</ul>
<h3 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a>新建项目</h3><h4 id="过程："><a href="#过程：" class="headerlink" title="过程："></a>过程：</h4><p>通过 Gradle 构建项目，添加 Kotlin 支持（如下图）</p>
<p><img src="http://7xsi11.com1.z0.glb.clouddn.com/kotlin-dev-plugin-1-001.png" alt=""></p>
<p>构建项目后，修改项目 build.gradle 文件，添加插件开发 SDK</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">buildscript</span> &#123;</div><div class="line">    ext.kotlin_version = <span class="string">'1.1.4-2'</span></div><div class="line"></div><div class="line">    <span class="keyword">repositories</span> &#123;</div><div class="line">        mavenCentral()</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">dependencies</span> &#123;</div><div class="line">        <span class="keyword">classpath</span> <span class="string">"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">plugins &#123;</div><div class="line">    id <span class="string">"org.jetbrains.intellij"</span> version <span class="string">"0.2.16"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">apply plugin: <span class="string">'org.jetbrains.intellij'</span></div><div class="line">apply plugin: <span class="string">'kotlin'</span></div><div class="line"></div><div class="line"><span class="comment">// 详细配置参数请看：https://github.com/JetBrains/gradle-intellij-plugin#configuration</span></div><div class="line">intellij &#123;</div><div class="line">    localPath <span class="string">'/Applications/IntelliJ IDEA CE.app'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">compileKotlin &#123;</div><div class="line">    kotlinOptions.jvmTarget = <span class="string">"1.8"</span></div><div class="line">&#125;</div><div class="line">compileTestKotlin &#123;</div><div class="line">    kotlinOptions.jvmTarget = <span class="string">"1.8"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">repositories</span> &#123;</div><div class="line">    mavenCentral()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">group</span> <span class="string">'com.fbsum.plugin'</span></div><div class="line">version <span class="string">'1.0-SNAPSHOT'</span></div><div class="line"></div><div class="line"><span class="keyword">dependencies</span> &#123;</div><div class="line">    <span class="keyword">compile</span> <span class="string">"org.jetbrains.kotlin:kotlin-stdlib-jre8:$kotlin_version"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>查看 External Libraries 确认配置成功</p>
<p><img src="http://7xsi11.com1.z0.glb.clouddn.com/kotlin-dev-plugin-1-002.png" alt=""></p>
<p>在 src/main/resources/ 目录下添加 META-INF/plugin.xml，修改相关信息，其中 id 等信息最好修改，否则可能出现无法调试的情况。</p>
<p><img src="http://7xsi11.com1.z0.glb.clouddn.com/kotlin-dev-plugin-1-003.png" alt=""></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">idea-plugin</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>org.jetbrains<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>my_plugin<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">vendor</span> <span class="attr">email</span>=<span class="string">"dummy"</span> <span class="attr">url</span>=<span class="string">"dummy"</span>&gt;</span>dummy<span class="tag">&lt;/<span class="name">vendor</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>&lt;![CDATA[</div><div class="line">      Sample plugin.&lt;br&gt;</div><div class="line">    ]]&gt;<span class="tag">&lt;/<span class="name">description</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">change-notes</span>&gt;</span>&lt;![CDATA[</div><div class="line">      Release 0.0.1: Initial release.&lt;br&gt;</div><div class="line">    ]]&gt;</div><div class="line">  <span class="tag">&lt;/<span class="name">change-notes</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- please see http://www.jetbrains.org/intellij/sdk/docs/basics/getting_started/build_number_ranges.html for description --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">idea-version</span> <span class="attr">since-build</span>=<span class="string">"162"</span>/&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- please see http://www.jetbrains.org/intellij/sdk/docs/basics/getting_started/plugin_compatibility.html</span></div><div class="line">       on how to target different products --&gt;</div><div class="line">  <span class="comment">&lt;!-- uncomment to enable plugin in all products</span></div><div class="line">  &lt;depends&gt;com.intellij.modules.lang&lt;/depends&gt;</div><div class="line">  --&gt;</div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">extensions</span> <span class="attr">defaultExtensionNs</span>=<span class="string">"com.intellij"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">extensions</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">actions</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;/<span class="name">actions</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">idea-plugin</span>&gt;</span></div></pre></td></tr></table></figure>
<p>创建 Action</p>
<p><img src="http://7xsi11.com1.z0.glb.clouddn.com/kotlin-dev-plugin-1-010.png" alt=""></p>
<p><img src="http://7xsi11.com1.z0.glb.clouddn.com/kotlin-dev-plugin-1-005.png" alt=""></p>
<p>将生成的 Action 转成 Kotlin 文件</p>
<p><img src="http://7xsi11.com1.z0.glb.clouddn.com/kotlin-dev-plugin-1-006.png" alt=""></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloAction</span> : <span class="type">AnAction</span></span>() &#123;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">actionPerformed</span><span class="params">(e: <span class="type">AnActionEvent</span>)</span></span> &#123;</div><div class="line">        <span class="keyword">val</span> project = e.project</div><div class="line">        <span class="keyword">val</span> s = Messages.showInputDialog(project, <span class="string">"What's your name?"</span>, <span class="string">"Hello"</span>, Messages.getQuestionIcon())</div><div class="line">        Messages.showMessageDialog(project, <span class="string">"Hello <span class="subst">$s</span>!"</span>, <span class="string">"Welcome"</span>, Messages.getInformationIcon())</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="运行项目"><a href="#运行项目" class="headerlink" title="运行项目"></a>运行项目</h2><p>运行 runIdea Task </p>
<p><img src="http://7xsi11.com1.z0.glb.clouddn.com/kotlin-dev-plugin-1-007.png" alt=""></p>
<p>查看插件</p>
<p><img src="http://7xsi11.com1.z0.glb.clouddn.com/kotlin-dev-plugin-1-008.png" alt=""></p>
<p><img src="http://7xsi11.com1.z0.glb.clouddn.com/kotlin-dev-plugin-1-009.png" alt=""></p>
<h2 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h2><p><a href="https://github.com/fbsum/HelloWorldPlugin" target="_blank" rel="external">https://github.com/fbsum/HelloWorldPlugin</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-11-17T08:29:27.000Z"><a href="/2016/11/17/githug/">2016-11-17</a></time>
      
      
  
    <h1 class="title"><a href="/2016/11/17/githug/">通关 githug</a></h1>
  

    </header>
    <div class="entry">
      
        <p>githug 是一个用来练习 git 命令的小游戏。项目地址：<a href="https://github.com/Gazler/githug" target="_blank" rel="external">https://github.com/Gazler/githug</a> </p>
<p>参考：<a href="http://www.jianshu.com/p/482b32716bbe" target="_blank" rel="external">「Githug」Git 游戏通关流程</a> </p>
<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>安装 ruby<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo dnf install ruby</div></pre></td></tr></table></figure></p>
<p>安装 githug<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem install githug</div></pre></td></tr></table></figure></p>
<h2 id="开始游戏"><a href="#开始游戏" class="headerlink" title="开始游戏"></a>开始游戏</h2><p>选择一个自己喜欢的目录开始游戏。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">githug</div></pre></td></tr></table></figure></p>
<p>提示创建游戏目录（如下），键入 y 确认。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">No githug directory found, <span class="keyword">do</span> you wish to create one? [yn]</div></pre></td></tr></table></figure></p>
<p>ps：githug 的主要命令有以下 4 个：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Githug has 4 game commands:</div><div class="line"></div><div class="line"><span class="comment"># 验证</span></div><div class="line">play - The default <span class="built_in">command</span>, checks your solution <span class="keyword">for</span> the current level</div><div class="line"><span class="comment"># 显示当前关卡的提示信息</span></div><div class="line">hint - Gives you a hint (<span class="keyword">if</span> available) <span class="keyword">for</span> the current level</div><div class="line"><span class="comment"># 重置关卡（可指定）</span></div><div class="line">reset - Reset the current level or reset the level to a given name or path</div><div class="line"><span class="comment"># 显示所有关卡</span></div><div class="line">levels - List all the levels</div></pre></td></tr></table></figure></p>
<h3 id="第一关（init）"><a href="#第一关（init）" class="headerlink" title="第一关（init）"></a>第一关（init）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: init</div><div class="line">Level: 1</div><div class="line">Difficulty: *</div><div class="line"></div><div class="line">A new directory, `git_hug`, has been created; initialize an empty repository <span class="keyword">in</span> it.</div></pre></td></tr></table></figure>
<p>在 git_hug 目录下初始化一个空仓库。初始化后，会在 git_hug 目录下创建一个 .git 目录，是 git 用来保存 git_hug 目录内容的跟踪管理信息，通常不需要手动修改。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> git_hug</div><div class="line">git init</div></pre></td></tr></table></figure></p>
<p>用 githug play 命令验证结果，成功就会直接进入下一关（该步骤在下文不再重复写）。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">githug play</div></pre></td></tr></table></figure></p>
<h3 id="第二关（config）"><a href="#第二关（config）" class="headerlink" title="第二关（config）"></a>第二关（config）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: config</div><div class="line">Level: 2</div><div class="line">Difficulty: *</div><div class="line"></div><div class="line">Set up your git name and email, this is important so that your commits can be identified.</div></pre></td></tr></table></figure>
<p>设置 git 的用户名和邮箱。–local 表示配置是属于仓库本地的，即配置只影响当前仓库；如果要设置全局配置，可使用 –global 参数。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git config --local user.name jiajieshen</div><div class="line">git config --local user.email scausum@163.com</div></pre></td></tr></table></figure></p>
<h3 id="第三关（add）"><a href="#第三关（add）" class="headerlink" title="第三关（add）"></a>第三关（add）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Name: add</div><div class="line">Level: 3</div><div class="line">Difficulty: *</div><div class="line"></div><div class="line">There is a file <span class="keyword">in</span> your folder called `README`, you should add it to your staging area</div><div class="line">Note: You start each level with a new repo. Don<span class="string">'t look for files from the previous one.</span></div></pre></td></tr></table></figure>
<p>将 README 文件添加进 staging area（暂存区） 。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git status <span class="comment">#（可选）</span></div><div class="line">git add README </div><div class="line">git status <span class="comment">#（可选）</span></div></pre></td></tr></table></figure></p>
<p>ps ：可使用 git status 命令查看文件在 git 跟踪管理中的状态。</p>
<ul>
<li>Changes to be committed 区域显示的是 staging area 的文件，可以被 commit 进入本地仓库。</li>
<li>Changes not staged for commit 区域显示的是 working directory 的文件，可以被 add 进 staging area 。</li>
<li>Untracked files 区域显示的是未被 git 跟踪管理的文件，可以被 add 进 staging area 。 </li>
</ul>
<h3 id="第四关（commit）"><a href="#第四关（commit）" class="headerlink" title="第四关（commit）"></a>第四关（commit）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: commit</div><div class="line">Level: 4</div><div class="line">Difficulty: *</div><div class="line"></div><div class="line">The `README` file has been added to your staging area, now commit it.</div></pre></td></tr></table></figure>
<p>提交 staging area 的内容到仓库。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git commit -m <span class="string">"注释"</span></div></pre></td></tr></table></figure></p>
<p>可列出指定要 commit 的文件。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git commit README -m <span class="string">"Add README"</span></div></pre></td></tr></table></figure></p>
<h3 id="第五关（clone）"><a href="#第五关（clone）" class="headerlink" title="第五关（clone）"></a>第五关（clone）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: <span class="built_in">clone</span></div><div class="line">Level: 5</div><div class="line">Difficulty: *</div><div class="line"></div><div class="line">Clone the repository at https://github.com/Gazler/cloneme.</div></pre></td></tr></table></figure>
<p>克隆一个仓库。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">clone</span> https://github.com/Gazler/cloneme</div></pre></td></tr></table></figure></p>
<h3 id="第六关（clone-to-folder）"><a href="#第六关（clone-to-folder）" class="headerlink" title="第六关（clone to folder）"></a>第六关（clone to folder）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: clone_to_folder</div><div class="line">Level: 6</div><div class="line">Difficulty: *</div><div class="line"></div><div class="line">Clone the repository at https://github.com/Gazler/cloneme to `my_cloned_repo`.</div></pre></td></tr></table></figure>
<p>克隆一个仓库并指定目录名。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">clone</span> https://github.com/Gazler/cloneme my_cloned_repo</div></pre></td></tr></table></figure></p>
<h3 id="第七关（ignore）"><a href="#第七关（ignore）" class="headerlink" title="第七关（ignore）"></a>第七关（ignore）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: ignore</div><div class="line">Level: 7</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">The text editor <span class="string">'vim'</span> creates files ending <span class="keyword">in</span> `.swp` (swap files) <span class="keyword">for</span> all files that are currently open.  We don<span class="string">'t want them creeping into the repository.  Make this repository ignore those swap files which are ending in `.swp`.</span></div></pre></td></tr></table></figure>
<p>忽略所有 .swp 文件。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vi .gitignore <span class="comment"># <span class="doctag">TODO:</span> 添加 *.swp</span></div></pre></td></tr></table></figure></p>
<h3 id="第八关（include）"><a href="#第八关（include）" class="headerlink" title="第八关（include）"></a>第八关（include）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: include</div><div class="line">Level: 8</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">Notice a few files with the <span class="string">'.a'</span> extension.  We want git to ignore all but the <span class="string">'lib.a'</span> file.\</div></pre></td></tr></table></figure>
<p>忽略除了 lib.a 文件以外的所有以 .a 作为后缀的文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">vi .gitignore <span class="comment"># TODO：添加忽略 *.a ，但 !lib.a</span></div><div class="line">githug play</div></pre></td></tr></table></figure></p>
<p>.gitignore 添加如下两行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">!lib.a</div><div class="line">*.a</div></pre></td></tr></table></figure></p>
<h3 id="第九关（status）"><a href="#第九关（status）" class="headerlink" title="第九关（status）"></a>第九关（status）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: status</div><div class="line">Level: 9</div><div class="line">Difficulty: *</div><div class="line"></div><div class="line">There are some files <span class="keyword">in</span> this repository, one of the files is untracked, <span class="built_in">which</span> file is it?</div></pre></td></tr></table></figure>
<p>找出未被 git 跟踪管理的文件。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git status <span class="comment"># TODO：查看 Untracked files 区域的文件</span></div><div class="line">githug play <span class="comment"># TODO：输入查看到的 untracked 文件</span></div></pre></td></tr></table></figure></p>
<h3 id="第十关（number-of-files-committed）"><a href="#第十关（number-of-files-committed）" class="headerlink" title="第十关（number of files committed）"></a>第十关（number of files committed）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: number_of_files_committed</div><div class="line">Level: 10</div><div class="line">Difficulty: *</div><div class="line"></div><div class="line">There are some files <span class="keyword">in</span> this repository, how many of the files will be committed?</div></pre></td></tr></table></figure>
<p>统计 staging area 的文件数。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git status <span class="comment"># TODO：查看 staging area 的文件数</span></div><div class="line">githug play <span class="comment"># TODO：输入 staging area 的文件数</span></div></pre></td></tr></table></figure></p>
<h3 id="第十一关（rm）"><a href="#第十一关（rm）" class="headerlink" title="第十一关（rm）"></a>第十一关（rm）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: rm</div><div class="line">Level: 11</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">A file has been removed from the working tree, however the file was not removed from the repository.  Find out what this file was and remove it.</div></pre></td></tr></table></figure>
<p>某个文件已经从硬盘删除，但没有从仓库中移除，需要找出并移除。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git status # TODO：查看工作目录，带有 deleted: 标识的就是被删除的文件</div><div class="line">git rm deleteme.rb # deleteme.rb 就是上面看到的文件</div><div class="line">git status # 可以看到 deleteme.rb 被放进了 staging area</div></pre></td></tr></table></figure></p>
<h3 id="第十二关（rm-cached）"><a href="#第十二关（rm-cached）" class="headerlink" title="第十二关（rm cached）"></a>第十二关（rm cached）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: rm_cached</div><div class="line">Level: 12</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">A file has accidentally been added to your staging area, find out <span class="built_in">which</span> file and remove it from the staging area.  *NOTE* Do not remove the file from the file system, only from git.</div></pre></td></tr></table></figure>
<p>将被意外地放进 staging area 的文件移除。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git status</div><div class="line">git rm --cached deleteme.rb <span class="comment"># deleteme.rb 就是意外 add 到 git 仓库的文件</span></div><div class="line">git status <span class="comment"># 可以看到 deleteme.rb 变成 untracked 状态</span></div></pre></td></tr></table></figure></p>
<h3 id="第十三关（stash）"><a href="#第十三关（stash）" class="headerlink" title="第十三关（stash）"></a>第十三关（stash）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: stash</div><div class="line">Level: 13</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">You<span class="string">'ve made some changes and want to work on them later. You should save them, but don'</span>t commit them.</div></pre></td></tr></table></figure>
<p>将当前工作目录的变更 stash（储藏）。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git status <span class="comment"># 可以看到当前工作目录的变更</span></div><div class="line">git stash</div><div class="line">git status <span class="comment"># 可以看到当前工作目录变干净了</span></div></pre></td></tr></table></figure></p>
<p>stash 只是将当前工作目录的变更储藏起来，没有 commit ，这很方便我们需要切换分支应对紧急工作，但又不想 commit 当前未完成的工作的情况。</p>
<h3 id="第十四关（rename）"><a href="#第十四关（rename）" class="headerlink" title="第十四关（rename）"></a>第十四关（rename）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: rename</div><div class="line">Level: 14</div><div class="line">Difficulty: ***</div><div class="line"></div><div class="line">We have a file called `oldfile.txt`. We want to rename it to `newfile.txt` and stage this change.</div></pre></td></tr></table></figure>
<p>重命名某个已经被 git 追踪管理的文件。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git mv oldfile.txt newfile.txt <span class="comment"># git mv 命令自动 stage 文件</span></div><div class="line">git status <span class="comment"># 可以看到 newfile.txt 已经放进 staging area</span></div></pre></td></tr></table></figure></p>
<h3 id="第十五关（restructure）"><a href="#第十五关（restructure）" class="headerlink" title="第十五关（restructure）"></a>第十五关（restructure）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: restructure</div><div class="line">Level: 15</div><div class="line">Difficulty: ***</div><div class="line"></div><div class="line">You added some files to your repository, but now realize that your project needs to be restructured.  Make a new folder named `src` and using Git move all of the .html files into this folder.</div></pre></td></tr></table></figure>
<p>将所有已经被 git 追踪管理的 .html 文件放进 src 目录。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir src</div><div class="line">git mv *.html src</div></pre></td></tr></table></figure></p>
<h3 id="第十六关（log）"><a href="#第十六关（log）" class="headerlink" title="第十六关（log）"></a>第十六关（log）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: <span class="built_in">log</span></div><div class="line">Level: 16</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">You will be asked <span class="keyword">for</span> the <span class="built_in">hash</span> of most recent commit.  You will need to investigate the logs of the repository <span class="keyword">for</span> this.</div></pre></td></tr></table></figure>
<p>查看提交日志。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">log</span> <span class="comment"># TODO：查看最新 commit 的 hash 值</span></div><div class="line">githug play <span class="comment"># TODO：输入最新 commit 的 hash 值</span></div></pre></td></tr></table></figure></p>
<h3 id="第十七关（tag）"><a href="#第十七关（tag）" class="headerlink" title="第十七关（tag）"></a>第十七关（tag）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: tag</div><div class="line">Level: 17</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">We have a git repo and we want to tag the current commit with `new_tag`.</div></pre></td></tr></table></figure>
<p>给最新的 commit 打 tag。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git tag new_tag <span class="comment"># 不加额外参数就是给最新 commit 打 tag，具体可 git tag --help 查看</span></div></pre></td></tr></table></figure></p>
<h3 id="第十八关（push-tags）"><a href="#第十八关（push-tags）" class="headerlink" title="第十八关（push tags）"></a>第十八关（push tags）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: push_tags</div><div class="line">Level: 18</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">There are tags <span class="keyword">in</span> the repository that aren<span class="string">'t pushed into remote repository. Push them now.</span></div></pre></td></tr></table></figure>
<p>将所有本地仓库的 tag 都推送到远程仓库。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git push --tag origin master</div></pre></td></tr></table></figure></p>
<h3 id="第十九关（commit-amend）"><a href="#第十九关（commit-amend）" class="headerlink" title="第十九关（commit amend）"></a>第十九关（commit amend）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: commit_amend</div><div class="line">Level: 19</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">The `README` file has been committed, but it looks like the file `forgotten_file.rb` was missing from the commit.  Add the file and amend your previous commit to include it.</div></pre></td></tr></table></figure>
<p>上次的提交漏掉一个文件，需要补上。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git status</div><div class="line">git add forgotten_file.rb</div><div class="line">git commit --amend <span class="comment"># TODO：可以修改之前提交的注释</span></div></pre></td></tr></table></figure></p>
<h3 id="第二十关（commit-in-future）"><a href="#第二十关（commit-in-future）" class="headerlink" title="第二十关（commit in future）"></a>第二十关（commit in future）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: commit_in_future</div><div class="line">Level: 20</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">Commit your changes with the future date (e.g. tomorrow).</div></pre></td></tr></table></figure>
<p>指定时间 commit。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git commit -m <span class="string">"githug test"</span> --date=19.11.2016</div></pre></td></tr></table></figure></p>
<h3 id="第二十一关（reset）"><a href="#第二十一关（reset）" class="headerlink" title="第二十一关（reset）"></a>第二十一关（reset）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: reset</div><div class="line">Level: 21</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">There are two files to be committed.  The goal was to add each file as a separate commit, however both were added by accident.  Unstage the file `to_commit_second.rb` using the reset <span class="built_in">command</span> (don<span class="string">'t commit anything).</span></div></pre></td></tr></table></figure>
<p>有两个文件已经添加到 staging area，想分开 commit，希望能将其中一个文件先 unstage。<br>reset 命令是用来做版本回退的。reset HEAD 就是回退到最新的 commit。设定不同参数可以对回退的内容做进一步的操作（见下一关）。reset 是比较重要的一个命令，需要去详细了解更多的用法。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git status</div><div class="line">git reset HEAD to_commit_second.rb</div><div class="line">git status</div></pre></td></tr></table></figure></p>
<p>注：这关即使使用 git rm –cached 命令也能通过，但表达的含义是不同的，注意区分。</p>
<ul>
<li>只有当文件在 staging area 是 new file 时，git rm –cached 与 git reset HEAD 才有同样的效果。</li>
</ul>
<h3 id="第二十二关（reset-soft）"><a href="#第二十二关（reset-soft）" class="headerlink" title="第二十二关（reset soft）"></a>第二十二关（reset soft）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: reset_soft</div><div class="line">Level: 22</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">You committed too soon. Now you want to undo the last commit, <span class="keyword">while</span> keeping the index.</div></pre></td></tr></table></figure>
<p>撤销上一次的提交并将提交的内容放回 staging area。</p>
<ul>
<li>–soft     将提交的内容放回 staging area</li>
<li>–mixed     重置 staging area，但不影响 working directory（默认）</li>
<li>–hard     重置 staging area 和 working directory</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git status</div><div class="line">git reset --soft HEAD^1</div><div class="line">git status</div></pre></td></tr></table></figure>
<h3 id="第二十三关（checkout-file）"><a href="#第二十三关（checkout-file）" class="headerlink" title="第二十三关（checkout file）"></a>第二十三关（checkout file）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: checkout_file</div><div class="line">Level: 23</div><div class="line">Difficulty: ***</div><div class="line"></div><div class="line">A file has been modified, but you don<span class="string">'t want to keep the modification.  Checkout the `config.rb` file from the last commit.</span></div></pre></td></tr></table></figure>
<p>根据最新的 commit 的版本来撤销当前文件的修改。</p>
<ul>
<li>checkout 不指定版本时，若 staging area 存在该文件的暂存，则用 staging area 的版本覆盖 working directory 的版本；</li>
<li>checkout 指定版本时，unstage 文件，并用仓库版本覆盖working directory 的版本<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git status</div><div class="line">git checkout HEAD config.rb</div><div class="line">git status</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="第二十四关（remote）"><a href="#第二十四关（remote）" class="headerlink" title="第二十四关（remote）"></a>第二十四关（remote）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: remote</div><div class="line">Level: 24</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">This project has a remote repository.  Identify it.</div></pre></td></tr></table></figure>
<p>查看远端仓库。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git remote</div></pre></td></tr></table></figure></p>
<h3 id="第二十五关（remote-url）"><a href="#第二十五关（remote-url）" class="headerlink" title="第二十五关（remote url）"></a>第二十五关（remote url）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: remote_url</div><div class="line">Level: 25</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">The remote repositories have a url associated to them.  Please enter the url of remote_location.</div></pre></td></tr></table></figure>
<p>查看远端仓库及其 url。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git remote -v</div><div class="line">githug play <span class="comment"># TODO：正确答案是 https://github.com/githug/not_a_repo</span></div></pre></td></tr></table></figure></p>
<h3 id="第二十六关（pull）"><a href="#第二十六关（pull）" class="headerlink" title="第二十六关（pull）"></a>第二十六关（pull）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: pull</div><div class="line">Level: 26</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">You need to pull changes from your origin repository.</div></pre></td></tr></table></figure>
<p>从远端拉取仓库。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git remote</div><div class="line">git pull origin master</div></pre></td></tr></table></figure></p>
<p>pull 命令的一般格式是：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git pull &lt;远程仓库名&gt; &lt;远程分支名&gt;:&lt;本地分支名&gt;</div></pre></td></tr></table></figure></p>
<h3 id="第二十七关（remote-add）"><a href="#第二十七关（remote-add）" class="headerlink" title="第二十七关（remote add）"></a>第二十七关（remote add）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: remote_add</div><div class="line">Level: 27</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">Add a remote repository called `origin` with the url https://github.com/githug/githug</div></pre></td></tr></table></figure>
<p>添加一个远程仓库。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git remote -v</div><div class="line">git remote add origin https://github.com/githug/githug <span class="comment"># origin 是远程仓库名</span></div><div class="line">git remote -v</div></pre></td></tr></table></figure></p>
<h3 id="第二十八关（push）"><a href="#第二十八关（push）" class="headerlink" title="第二十八关（push）"></a>第二十八关（push）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: push</div><div class="line">Level: 28</div><div class="line">Difficulty: ***</div><div class="line"></div><div class="line">Your <span class="built_in">local</span> master branch has diverged from the remote origin/master branch. Rebase your commit onto origin/master and push it to remote.</div></pre></td></tr></table></figure>
<p>从本地推送更新到远程仓库。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git rebase origin master</div><div class="line">git push origin master</div></pre></td></tr></table></figure></p>
<p>push 命令的一般格式是：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git push &lt;远程仓库名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;</div></pre></td></tr></table></figure></p>
<h3 id="第二十九关（diff）"><a href="#第二十九关（diff）" class="headerlink" title="第二十九关（diff）"></a>第二十九关（diff）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: diff</div><div class="line">Level: 29</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">There have been modifications to the `app.rb` file since your last commit.  Find out <span class="built_in">which</span> line has changed.</div></pre></td></tr></table></figure>
<p>查看文件差异。</p>
<ul>
<li>git diff：查看 working directory 与 staging area 之间的差异</li>
<li>git diff –cached：查看 repository 与 staging area 之间的差异</li>
<li>git diff HEAD：查看 repositiory 与 working directory 之间的差异<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git diff</div><div class="line">githug play <span class="comment"># What is the number of the line which has changed? 26</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>diff 显示的差异：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">diff --git a/app.rb b/app.rb</div><div class="line">index 4f703ca..3bfa839 100644</div><div class="line">--- a/app.rb</div><div class="line">+++ b/app.rb</div><div class="line">@@ -23,7 +23,7 @@ get &apos;/yet_another&apos; do</div><div class="line">   erb :success</div><div class="line"> end</div><div class="line"> get &apos;/another_page&apos; do</div><div class="line">-  @message = get_response(&apos;data.json&apos;)</div><div class="line">+  @message = get_response(&apos;server.json&apos;)</div><div class="line">   erb :another</div><div class="line"> end</div></pre></td></tr></table></figure></p>
<h3 id="第三十关（blame）"><a href="#第三十关（blame）" class="headerlink" title="第三十关（blame）"></a>第三十关（blame）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: blame</div><div class="line">Level: 30</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">Someone has put a password inside the file `config.rb` find out who it was.</div></pre></td></tr></table></figure>
<p>查看文件内容的修改人。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git blame config.rb</div><div class="line">githug play <span class="comment"># Who made the commit with the password? Spider Man</span></div></pre></td></tr></table></figure></p>
<h3 id="第三十一关（branch）"><a href="#第三十一关（branch）" class="headerlink" title="第三十一关（branch）"></a>第三十一关（branch）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: branch</div><div class="line">Level: 31</div><div class="line">Difficulty: *</div><div class="line"></div><div class="line">You want to work on a piece of code that has the potential to <span class="built_in">break</span> things, create the branch test_code.</div></pre></td></tr></table></figure>
<p>创建分支。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git branch</div><div class="line">git branch test_code</div><div class="line">git branch</div></pre></td></tr></table></figure></p>
<h3 id="第三十二关（checkout）"><a href="#第三十二关（checkout）" class="headerlink" title="第三十二关（checkout）"></a>第三十二关（checkout）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: checkout</div><div class="line">Level: 32</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">Create and switch to a new branch called my_branch.  You will need to create a branch like you did <span class="keyword">in</span> the previous level.</div></pre></td></tr></table></figure>
<p>创建一个分支，并切换到新创建的分支。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git branch my_branch</div><div class="line">git checkout my_branch</div></pre></td></tr></table></figure></p>
<p>or<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git checkout -b branch</div></pre></td></tr></table></figure></p>
<h3 id="第三十三关（checkout-tag）"><a href="#第三十三关（checkout-tag）" class="headerlink" title="第三十三关（checkout tag）"></a>第三十三关（checkout tag）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: checkout_tag</div><div class="line">Level: 33</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">You need to fix a bug <span class="keyword">in</span> the version 1.2 of your app. Checkout the tag `v1.2`.</div></pre></td></tr></table></figure>
<p>切换 HEAD 到指定的 tag。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git tag <span class="comment"># 查看 tag</span></div><div class="line">git checkout v1.2 <span class="comment"># v1.2是 tag。</span></div></pre></td></tr></table></figure></p>
<h3 id="第三十四关（checkout-tag-over-branch）"><a href="#第三十四关（checkout-tag-over-branch）" class="headerlink" title="第三十四关（checkout tag over branch）"></a>第三十四关（checkout tag over branch）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: checkout_tag_over_branch</div><div class="line">Level: 34</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">You need to fix a bug <span class="keyword">in</span> the version 1.2 of your app. Checkout the tag `v1.2` (Note: There is also a branch named `v1.2`).</div></pre></td></tr></table></figure>
<p>切换 HEAD 到指定 tag，但存在相同的标签名和分支名。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># git branch</span></div><div class="line"><span class="comment"># git tag</span></div><div class="line">git checkout tags/v1.2</div></pre></td></tr></table></figure></p>
<h3 id="第三十五关（branch-at）"><a href="#第三十五关（branch-at）" class="headerlink" title="第三十五关（branch at）"></a>第三十五关（branch at）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: branch_at</div><div class="line">Level: 35</div><div class="line">Difficulty: ***</div><div class="line"></div><div class="line">You forgot to branch at the previous commit and made a commit on top of it. Create branch test_branch at the commit before the last.</div></pre></td></tr></table></figure>
<p>根据一个指定的提交来创建分支。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git branch test_branch HEAD^1</div></pre></td></tr></table></figure></p>
<h3 id="第三十六关（delete-branch）"><a href="#第三十六关（delete-branch）" class="headerlink" title="第三十六关（delete branch）"></a>第三十六关（delete branch）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: delete_branch</div><div class="line">Level: 36</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">You have created too many branches <span class="keyword">for</span> your project. There is an old branch <span class="keyword">in</span> your repo called <span class="string">'delete_me'</span>, you should delete it.</div></pre></td></tr></table></figure>
<p>删除一个分支。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git branch <span class="_">-d</span> delete_me</div></pre></td></tr></table></figure></p>
<h3 id="第三十七关（push-branch）"><a href="#第三十七关（push-branch）" class="headerlink" title="第三十七关（push branch）"></a>第三十七关（push branch）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: push_branch</div><div class="line">Level: 37</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">You<span class="string">'ve made some changes to a local branch and want to share it, but aren'</span>t yet ready to merge it with the <span class="string">'master'</span> branch.  Push only <span class="string">'test_branch'</span> to the remote repository</div></pre></td></tr></table></figure>
<p>将分支推送到远程仓库。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git branch</div><div class="line">git push origin test_branch test_branch</div></pre></td></tr></table></figure></p>
<h3 id="第三十八关（merge）"><a href="#第三十八关（merge）" class="headerlink" title="第三十八关（merge）"></a>第三十八关（merge）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: merge</div><div class="line">Level: 38</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">We have a file <span class="keyword">in</span> the branch <span class="string">'feature'</span>; Let<span class="string">'s merge it to the master branch.</span></div></pre></td></tr></table></figure>
<p>合并分支。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git branch</div><div class="line">git merge feature</div></pre></td></tr></table></figure></p>
<h3 id="第三十九关（fetch）"><a href="#第三十九关（fetch）" class="headerlink" title="第三十九关（fetch）"></a>第三十九关（fetch）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: fetch</div><div class="line">Level: 39</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">Looks like a new branch was pushed into our remote repository. Get the changes without merging them with the <span class="built_in">local</span> repository</div></pre></td></tr></table></figure>
<p>拉去远程仓库的更新，但不与当前分支合并。git pull 相当于 git fetch 和 git merge 的组合。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git fetch origin</div></pre></td></tr></table></figure></p>
<h3 id="第四十关（rebase）"><a href="#第四十关（rebase）" class="headerlink" title="第四十关（rebase）"></a>第四十关（rebase）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: rebase</div><div class="line">Level: 40</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">We are using a git rebase workflow and the feature branch is ready to go into master. Let<span class="string">'s rebase the feature branch onto our master branch.</span></div></pre></td></tr></table></figure>
<p>rebase（变基）feature 分支到 master 分支。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git rebase master feature</div></pre></td></tr></table></figure></p>
<p>变基前：<br><img src="http://7xsi11.com1.z0.glb.clouddn.com/rebase_0.png?attname=" alt=""> </p>
<p>变基后：<br><img src="http://7xsi11.com1.z0.glb.clouddn.com/rebase_1.png?attname=" alt=""> </p>
<h3 id="第四十一关（rebase-onto）"><a href="#第四十一关（rebase-onto）" class="headerlink" title="第四十一关（rebase onto）"></a>第四十一关（rebase onto）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: rebase_onto</div><div class="line">Level: 41</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">You have created your branch from `wrong_branch` and already made some commits, and you realise that you needed to create your branch from `master`. Rebase your commits onto `master` branch so that you don<span class="string">'t have `wrong_branch` commits.</span></div></pre></td></tr></table></figure>
<p>从错误的分支 wrong_branch 创建了一个分支 readme-update，并做了一些提交，但意识到应该是要从 master 分支来创建 readme-update分支的，希望将 readme-update 分支的几个新的提交都应用到 master 上，从而抛弃 wrong_branch 分支。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git rebase --onto master wrong_branch readme-update</div></pre></td></tr></table></figure></p>
<p>命令的大概可以理解为，以 master 为新基底，应用从 wrong_branch 的基底开始的readme-update 分支。<br>变基前：<br><img src="http://7xsi11.com1.z0.glb.clouddn.com/rebase_onto_0.png?attname=" alt=""> </p>
<p>变基后：<br><img src="http://7xsi11.com1.z0.glb.clouddn.com/rebase_onto_1.png?attname=" alt=""> </p>
<h3 id="第四十二关（repack）"><a href="#第四十二关（repack）" class="headerlink" title="第四十二关（repack）"></a>第四十二关（repack）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: repack</div><div class="line">Level: 42</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">Optimise how your repository is packaged ensuring that redundant packs are removed.</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git repack</div><div class="line">git repack <span class="_">-d</span></div></pre></td></tr></table></figure>
<h3 id="第四十三关（cherry-pick）"><a href="#第四十三关（cherry-pick）" class="headerlink" title="第四十三关（cherry pick）"></a>第四十三关（cherry pick）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: cherry-pick</div><div class="line">Level: 43</div><div class="line">Difficulty: ***</div><div class="line"></div><div class="line">Your new feature isn<span class="string">'t worth the time and you'</span>re going to delete it. But it has one commit that fills <span class="keyword">in</span> `README` file, and you want this commit to be on the master as well.</div></pre></td></tr></table></figure>
<p>应用某个指定的提交。从 feature 分支拾取 “Filled in README.md with proper input” 这个提交到当前分支。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git cherry-pick ca32a6d <span class="comment"># ca32a6d 是 commit 的 hash 值</span></div></pre></td></tr></table></figure></p>
<p>cherry-pick 前：<br><img src="http://7xsi11.com1.z0.glb.clouddn.com/cherry-pick-0.png?attname=" alt=""> </p>
<p>cherry-pick 后：<br><img src="http://7xsi11.com1.z0.glb.clouddn.com/cherry-pick-1.png?attname=" alt=""> </p>
<h3 id="第四十四关（grep）"><a href="#第四十四关（grep）" class="headerlink" title="第四十四关（grep）"></a>第四十四关（grep）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: grep</div><div class="line">Level: 44</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">Your project<span class="string">'s deadline approaches, you should evaluate how many TODOs are left in your code</span></div></pre></td></tr></table></figure>
<p>git grep 搜索。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git grep TODO</div></pre></td></tr></table></figure></p>
<h3 id="第四十五关（rename-commit）"><a href="#第四十五关（rename-commit）" class="headerlink" title="第四十五关（rename commit）"></a>第四十五关（rename commit）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: rename_commit</div><div class="line">Level: 45</div><div class="line">Difficulty: ***</div><div class="line"></div><div class="line">Correct the typo <span class="keyword">in</span> the message of your first (non-root) commit.</div></pre></td></tr></table></figure>
<p>重命名提交。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">log</span> <span class="comment"># TODO：查看提交日志，找到需要修改的 commit 之前的 commit 的 hash 值</span></div><div class="line">git rebase -i ae057e077f49908282f685e224cc99ef493a1718</div></pre></td></tr></table></figure></p>
<p>提交日志如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">commit 3d2f6ea75f6488db71db5f528743a2c48b43ce8d</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Sun Nov 20 22:31:41 2016 +0800</div><div class="line"></div><div class="line">    Second commit</div><div class="line"></div><div class="line">commit 5bd94ef24bd739de53e5ffd2fe3ebba02db4f699</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Sun Nov 20 22:31:41 2016 +0800</div><div class="line"></div><div class="line">    First coommit</div><div class="line"></div><div class="line">commit ae057e077f49908282f685e224cc99ef493a1718</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Sun Nov 20 22:31:41 2016 +0800</div><div class="line"></div><div class="line">    Initial commit</div></pre></td></tr></table></figure></p>
<p>git rebase -i 命令会列出指定 commit 之后的所有 commit，然后可以根据需要指定操作。本关需要的操作是重命名，具体修改如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">reword e7e5b6c First coommit <span class="comment"># pick 修改为 reword</span></div><div class="line">pick c8c97c1 Second commit</div></pre></td></tr></table></figure></p>
<p>修改之后，保存退出。<br>会弹出新的编辑窗口，将错误拼写的 coommit 改为 commit，然后保存退出即可。</p>
<h3 id="第四十六关（squash）"><a href="#第四十六关（squash）" class="headerlink" title="第四十六关（squash）"></a>第四十六关（squash）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: squash</div><div class="line">Level: 46</div><div class="line">Difficulty: ****</div><div class="line"></div><div class="line">You have committed several <span class="built_in">times</span> but would like all those changes to be one commit.</div></pre></td></tr></table></figure>
<p>压缩多个提交历史。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">log</span></div><div class="line">git rebase -i 3f8f811c65eee4f2ab08c50174f6b8443c63cf5d</div></pre></td></tr></table></figure></p>
<p>日志如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">commit e71814b6ab0c0d26f35f19bb2f0c9ee1c0d42965</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Sun Nov 20 22:32:41 2016 +0800</div><div class="line"></div><div class="line">    Updating README (squash this commit into Adding README)</div><div class="line"></div><div class="line">commit 37224b11c1bb4e3b13eb3fdb0d1f54d05158c3b7</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Sun Nov 20 22:32:41 2016 +0800</div><div class="line"></div><div class="line">    Updating README (squash this commit into Adding README)</div><div class="line"></div><div class="line">commit 951137b9fbe5e65c419afd1c129ac6a791a31298</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Sun Nov 20 22:32:41 2016 +0800</div><div class="line"></div><div class="line">    Updating README (squash this commit into Adding README)</div><div class="line"></div><div class="line">commit 6d2c1edb31691bc28791a4e6950a7d979a82a5fd</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Sun Nov 20 22:32:41 2016 +0800</div><div class="line"></div><div class="line">    Adding README</div><div class="line"></div><div class="line">commit 3f8f811c65eee4f2ab08c50174f6b8443c63cf5d</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Sun Nov 20 22:32:41 2016 +0800</div><div class="line"></div><div class="line">    Initial Commit</div><div class="line">~</div><div class="line">(END)</div></pre></td></tr></table></figure></p>
<p>指定 squash 操作，保存并退出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">pick 6d2c1ed Adding README</div><div class="line">squash 951137b Updating README (squash this commit into Adding README)</div><div class="line">squash 37224b1 Updating README (squash this commit into Adding README)</div><div class="line">squash e71814b Updating README (squash this commit into Adding README)</div></pre></td></tr></table></figure></p>
<p>之后，修改注释，保存退出，即可。</p>
<h3 id="第四十七关（merge-squash）"><a href="#第四十七关（merge-squash）" class="headerlink" title="第四十七关（merge squash）"></a>第四十七关（merge squash）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: merge_squash</div><div class="line">Level: 47</div><div class="line">Difficulty: ***</div><div class="line"></div><div class="line">Merge all commits from the long-feature-branch as a single commit.</div></pre></td></tr></table></figure>
<p>将某个分支的全部提交都压缩成一个提交，并将所有的修改内容放进 staging area。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git status <span class="comment"># 处在 master 分支</span></div><div class="line">git merge --squash long-feature-branch</div><div class="line">git commit -m <span class="string">"merge long-feature-branch"</span></div></pre></td></tr></table></figure></p>
<h3 id="第四十八关（reorder）"><a href="#第四十八关（reorder）" class="headerlink" title="第四十八关（reorder）"></a>第四十八关（reorder）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: reorder</div><div class="line">Level: 48</div><div class="line">Difficulty: ****</div><div class="line"></div><div class="line">You have committed several <span class="built_in">times</span> but <span class="keyword">in</span> the wrong order. Please reorder your commits.</div></pre></td></tr></table></figure>
<p>重新排序提交历史。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">log</span> </div><div class="line">git rebase -i 62cbe4cb0e967a09e15db355350f98a836a10e33</div><div class="line">git <span class="built_in">log</span></div></pre></td></tr></table></figure></p>
<p>日志如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">commit d5bd44db5e933cf0277b2a310ff49516c767053e</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Sun Nov 20 22:49:47 2016 +0800</div><div class="line"></div><div class="line">    Second commit</div><div class="line"></div><div class="line">commit aa2be89748b772c55f99cc3e3d2995cc90aa8a07</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Sun Nov 20 22:49:47 2016 +0800</div><div class="line"></div><div class="line">    Third commit</div><div class="line"></div><div class="line">commit dac3c422bdd7896cc218023bf5c9fa108f4108b0</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Sun Nov 20 22:49:47 2016 +0800</div><div class="line"></div><div class="line">    First commit</div><div class="line"></div><div class="line">commit 62cbe4cb0e967a09e15db355350f98a836a10e33</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Sun Nov 20 22:49:47 2016 +0800</div><div class="line"></div><div class="line">    Initial Setup</div></pre></td></tr></table></figure></p>
<p>将 Second commit 与 Thrid commit 所在行按正确顺序重排，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pick dac3c42 First commit</div><div class="line">pick d5bd44d Second commit</div><div class="line">pick aa2be89 Third commit</div></pre></td></tr></table></figure></p>
<p>保存退出。</p>
<h3 id="第四十九关（bisect）"><a href="#第四十九关（bisect）" class="headerlink" title="第四十九关（bisect）"></a>第四十九关（bisect）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: bisect</div><div class="line">Level: 49</div><div class="line">Difficulty: ***</div><div class="line"></div><div class="line">A bug was introduced somewhere along the way.  You know that running `ruby prog.rb 5` should output 15.  You can also run `make <span class="built_in">test</span>`.  What are the first 7 chars of the <span class="built_in">hash</span> of the commit that introduced the bug.</div></pre></td></tr></table></figure>
<p>这关是关于 git 调试的二分查找，不太懂。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git bisect start master f608824</div><div class="line">git bisect run make <span class="built_in">test</span></div><div class="line">githug play <span class="comment"># TODO：答案是 18ed2ac1</span></div></pre></td></tr></table></figure></p>
<h3 id="第五十关（stage-lines）"><a href="#第五十关（stage-lines）" class="headerlink" title="第五十关（stage lines）"></a>第五十关（stage lines）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: stage_lines</div><div class="line">Level: 50</div><div class="line">Difficulty: ****</div><div class="line"></div><div class="line">You<span class="string">'ve made changes within a single file that belong to two different features, but neither of the changes are yet staged. Stage only the changes belonging to the first feature.</span></div></pre></td></tr></table></figure>
<p>提交文件的部分修改。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git status</div><div class="line">git add -p feature.rb</div></pre></td></tr></table></figure></p>
<p>git add -p 允许在提交前对要提交的内容做操作。本关出现提示如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">diff --git a/feature.rb b/feature.rb</div><div class="line">index 1a271e9..4a80dda 100644</div><div class="line">--- a/feature.rb</div><div class="line">+++ b/feature.rb</div><div class="line">@@ -1 +1,3 @@</div><div class="line"> this is the class of my feature</div><div class="line">+This change belongs to the first feature</div><div class="line">+This change belongs to the second feature</div><div class="line">Stage this hunk [y,n,q,a,d,/,e,?]? e</div></pre></td></tr></table></figure></p>
<p>输入 e。参数说明如下：</p>
<ul>
<li>y - stage this hunk</li>
<li>n - do not stage this hunk</li>
<li>q - quit; do not stage this hunk nor any of the remaining ones</li>
<li>a - stage this hunk and all later hunks in the file</li>
<li>d - do not stage this hunk nor any of the later hunks in the file</li>
<li>/ - search for a hunk matching the given regex</li>
<li>e - manually edit the current hunk</li>
<li>? - print help</li>
</ul>
<p>输入 e 后，转到新编辑窗口，删除不需要 add 的内容，该操作不会影响 working directory 的文件，结果如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Manual hunk edit mode -- see bottom for a quick guide</span></div><div class="line">@@ -1 +1,3 @@</div><div class="line"> this is the class of my feature</div><div class="line">+This change belongs to the first feature</div><div class="line"><span class="comment"># ---</span></div><div class="line">......</div></pre></td></tr></table></figure></p>
<p>保存退出，即可。检查变化：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git diff</div><div class="line">git status</div></pre></td></tr></table></figure></p>
<h3 id="第五十一关（find-old-branch）"><a href="#第五十一关（find-old-branch）" class="headerlink" title="第五十一关（find old branch）"></a>第五十一关（find old branch）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: find_old_branch</div><div class="line">Level: 51</div><div class="line">Difficulty: ****</div><div class="line"></div><div class="line">You have been working on a branch but got distracted by a major issue and forgot the name of it. Switch back to that branch.</div></pre></td></tr></table></figure>
<p>寻找忘记 name 的分支。本关通过 git reflog 列出所有操作记录来寻找。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git reflog</div><div class="line">git checkout solve_world_hunger <span class="comment"># solve_world_hunger 是分支名</span></div></pre></td></tr></table></figure></p>
<p>git reflog 的输出如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">894a16d HEAD@&#123;0&#125;: commit: commit another todo</div><div class="line">6876e5b HEAD@&#123;1&#125;: checkout: moving from solve_world_hunger to kill_the_batman</div><div class="line">324336a HEAD@&#123;2&#125;: commit: commit todo</div><div class="line">6876e5b HEAD@&#123;3&#125;: checkout: moving from blowup_sun_for_ransom to solve_world_hunger</div><div class="line">6876e5b HEAD@&#123;4&#125;: checkout: moving from kill_the_batman to blowup_sun_for_ransom</div><div class="line">6876e5b HEAD@&#123;5&#125;: checkout: moving from cure_common_cold to kill_the_batman</div><div class="line">6876e5b HEAD@&#123;6&#125;: commit (initial): initial commit</div></pre></td></tr></table></figure></p>
<h3 id="第五十二关（revert）"><a href="#第五十二关（revert）" class="headerlink" title="第五十二关（revert）"></a>第五十二关（revert）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Name: revert</div><div class="line">Level: 52</div><div class="line">Difficulty: ****</div><div class="line"></div><div class="line">You have committed several <span class="built_in">times</span> but want to undo the middle commit.</div><div class="line">All commits have been pushed, so you can<span class="string">'t change existing history.</span></div></pre></td></tr></table></figure>
<p>撤销提交历史中间的某个提交，不能改变已存在的提交历史。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">log</span></div><div class="line">git revert HEAD^1</div><div class="line">git <span class="built_in">log</span></div></pre></td></tr></table></figure></p>
<p>revert 前的 log 如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">commit 3f0f4295b8c5c62cfa7a6322f9016ab5c1af9294</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Tue Nov 22 21:56:25 2016 +0800</div><div class="line"></div><div class="line">    Second commit</div><div class="line"></div><div class="line">commit 0f8d1668981f55a4a7ff48bf083465be78978f1d</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Tue Nov 22 21:56:24 2016 +0800</div><div class="line"></div><div class="line">    Bad commit</div><div class="line"></div><div class="line">commit 7531dde295446e41d885a4038536432414ea608b</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Tue Nov 22 21:56:24 2016 +0800</div><div class="line"></div><div class="line">    First commit</div></pre></td></tr></table></figure></p>
<p>revert 会生成新的 commit。revert 后的 log 如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">commit 17ad1b09ffaadb7aec03a2de4c46f05b2e40a980</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Tue Nov 22 21:56:52 2016 +0800</div><div class="line"></div><div class="line">    Revert <span class="string">"Bad commit"</span></div><div class="line">    </div><div class="line">    This reverts commit 0f8d1668981f55a4a7ff48bf083465be78978f1d.</div><div class="line"></div><div class="line">commit 3f0f4295b8c5c62cfa7a6322f9016ab5c1af9294</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Tue Nov 22 21:56:25 2016 +0800</div><div class="line"></div><div class="line">    Second commit</div><div class="line"></div><div class="line">commit 0f8d1668981f55a4a7ff48bf083465be78978f1d</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Tue Nov 22 21:56:24 2016 +0800</div><div class="line"></div><div class="line">    Bad commit</div><div class="line"></div><div class="line">commit 7531dde295446e41d885a4038536432414ea608b</div><div class="line">Author: sum &lt;sum@localhost.localdomain&gt;</div><div class="line">Date:   Tue Nov 22 21:56:24 2016 +0800</div><div class="line"></div><div class="line">    First commit</div></pre></td></tr></table></figure></p>
<p>revert 与 reset 不同。</p>
<ul>
<li>revert 只撤销当前的 commit，不会影响之后的 commit</li>
<li>reset 会将指定的 commit 之后的所有 commit 都退回 staging area 或丢弃</li>
</ul>
<h3 id="第五十三关（restore）"><a href="#第五十三关（restore）" class="headerlink" title="第五十三关（restore）"></a>第五十三关（restore）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: restore</div><div class="line">Level: 53</div><div class="line">Difficulty: ****</div><div class="line"></div><div class="line">You decided to delete your latest commit by running `git reset --hard HEAD^`.  (Not a smart thing to do.)  You <span class="keyword">then</span> change your mind, and want that commit back.  Restore the deleted commit.</div></pre></td></tr></table></figure>
<p>错误撤销 commit 后，恢复被删除的 commit。思路是根据 git reflog 查看所有操作记录，找到误操作之前的 commit id，然后恢复。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git reflog</div><div class="line">git checkout 2855121 <span class="comment"># 2855121 是被错误回退的 commit 的 hash 值</span></div></pre></td></tr></table></figure></p>
<p>git reflog 输出如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">36df271 HEAD@&#123;0&#125;: reset: moving to HEAD^</div><div class="line">2855121 HEAD@&#123;1&#125;: commit: Restore this commit</div><div class="line">36df271 HEAD@&#123;2&#125;: commit: First commit</div><div class="line">3c525b4 HEAD@&#123;3&#125;: commit (initial): Initial commit</div></pre></td></tr></table></figure></p>
<h3 id="第五十四关（conflict）"><a href="#第五十四关（conflict）" class="headerlink" title="第五十四关（conflict）"></a>第五十四关（conflict）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: conflict</div><div class="line">Level: 54</div><div class="line">Difficulty: ****</div><div class="line"></div><div class="line">You need to merge mybranch into the current branch (master). But there may be some incorrect changes <span class="keyword">in</span> mybranch <span class="built_in">which</span> may cause conflicts. Solve any merge-conflicts you come across and finish the merge.</div></pre></td></tr></table></figure>
<p>解决冲突。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">git branch</div><div class="line">git merge mybranch</div><div class="line">vi poem.txt</div><div class="line">git add poem.txt</div><div class="line">git commit -m <span class="string">"merge mybranch"</span></div><div class="line">git merge mybranch</div></pre></td></tr></table></figure></p>
<p>vi 修改前 poem.text 内容如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Humpty dumpty</div><div class="line">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</div><div class="line">Categorized shoes by color</div><div class="line">=======</div><div class="line">Sat on a wall</div><div class="line">&gt;&gt;&gt;&gt;&gt;&gt;&gt; mybranch</div><div class="line">Humpty dumpty</div><div class="line">Had a great fall</div></pre></td></tr></table></figure></p>
<p>冲突文件中 &lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD 到 ======= 之间的内容代表当前分支的修改，======= 到 &gt;&gt;&gt;&gt;&gt;&gt;&gt; 之间的内容代表 mybranch 分支的修改。<br>本关保留 mybranch 的修改即可，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Humpty dumpty</div><div class="line">Sat on a wall</div><div class="line">Humpty dumpty</div><div class="line">Had a great fall</div></pre></td></tr></table></figure></p>
<h3 id="第五十五关（submodule）"><a href="#第五十五关（submodule）" class="headerlink" title="第五十五关（submodule）"></a>第五十五关（submodule）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: submodule</div><div class="line">Level: 55</div><div class="line">Difficulty: **</div><div class="line"></div><div class="line">You want to include the files from the following repo: `https://github.com/jackmaney/githug-include-me` into a the folder `./githug-include-me`. Do this without manually cloning the repo or copying the files from the repo into this repo.</div></pre></td></tr></table></figure>
<p>子模块。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git submodule add https://github.com/jackmaney/githug-include-me ./githug-include-me</div></pre></td></tr></table></figure></p>
<h3 id="第五十六关（contribute）"><a href="#第五十六关（contribute）" class="headerlink" title="第五十六关（contribute）"></a>第五十六关（contribute）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Name: contribute</div><div class="line">Level: 56</div><div class="line">Difficulty: ***</div><div class="line"></div><div class="line">This is the final level, the goal is to contribute to this repository by making a pull request on GitHub.  Please note that this level is designed to encourage you to add a valid contribution to Githug, not testing your ability to create a pull request.  Contributions that are likely to be accepted are levels, bug fixes and improved documentation.</div></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-11-09T09:58:51.000Z"><a href="/2016/11/09/install-phpMyAdmin/">2016-11-09</a></time>
      
      
  
    <h1 class="title"><a href="/2016/11/09/install-phpMyAdmin/">CentOS 服务器安装 phpMyAdmin</a></h1>
  

    </header>
    <div class="entry">
      
        <p>注：本实践过程是基于 CentOS 服务器<br>参考：<a href="http://www.tecmint.com/install-phpmyadmin-rhel-centos-fedora-linux/" target="_blank" rel="external">Install Latest PhpMyAdmin in RHEL/CentOS 7/6 and Fedora 24-20</a> </p>
<h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2><h3 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h3><p><a href="http://jiajieshen.github.io/2016/11/02/lnmp/">CentOS 服务器搭建 LNMP 环境</a> </p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install phpMyAdmin</div></pre></td></tr></table></figure>
<h3 id="创建软连接"><a href="#创建软连接" class="headerlink" title="创建软连接"></a>创建软连接</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ln <span class="_">-s</span> /usr/share/phpMyAdmin /usr/share/nginx/html</div></pre></td></tr></table></figure>
<h3 id="重启服务"><a href="#重启服务" class="headerlink" title="重启服务"></a>重启服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">systemctl restart nginx</div><div class="line">systemctl restart php-fpm</div></pre></td></tr></table></figure>
<h3 id="解决错误警告"><a href="#解决错误警告" class="headerlink" title="解决错误警告"></a>解决错误警告</h3><p>此时在浏览器中输入 http;//host:port/phpMyAdmin (host:port 对应实际的服务器域名和端口)，就可以看到 phpMyAdmin 可以访问了。</p>
<p>不过可以发现页面出现错误警告如下：</p>
<p><img src="http://7xsi11.com1.z0.glb.clouddn.com/phpmyadmin-session-error.png?attname=" alt=""> </p>
<p>修改对应 session 目录的访问权限：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> /var/lib/php</div><div class="line">chmod 777 session</div></pre></td></tr></table></figure>
<p>刷新浏览器后，错误提示消失。进入 phpMyAdmin 后会有如下配置错误提示：</p>
<p><img src="http://7xsi11.com1.z0.glb.clouddn.com/phpmyadmin-config-error.png?attname=" alt=""> </p>
<ol>
<li><p>高级功能未设置这个问题很好解决，点“查找原因”，然后根据提示生成相应的数据表就可以了。</p>
<p> 如果没有生成的提示，就去点击随便一个数据库的“操作”选项卡，就会有提示了。（这里忘了截图）</p>
<p></p>
</li>
<li><p>“配置文件现在需要一个短语密码”的解决</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> /usr/share/phpMyAdmin/</div><div class="line">vi libraries/config.default.php</div><div class="line"><span class="comment">#<span class="doctag">TODO:</span> 将 $cfg['blowfish_secret'] = ''; 的值修改为任意随机32位字符。</span></div></pre></td></tr></table></figure>
<p>刷新网页，重新登录 phpMyAdmin ，错误消失。</p>
<p>可以正常使用 phpMyAdmin 了。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-11-02T09:37:51.000Z"><a href="/2016/11/02/lnmp/">2016-11-02</a></time>
      
      
  
    <h1 class="title"><a href="/2016/11/02/lnmp/">CentOS 服务器搭建 LNMP 环境</a></h1>
  

    </header>
    <div class="entry">
      
        <p>注：本实践过程基 CentOS 服务器<br>参考 ： <a href="http://www.tecmint.com/install-nginx-mariadb-php-rhel-centos-fedora/" target="_blank" rel="external">Install Latest Nginx 1.10.1, MariaDB 10 and PHP 5.5/5.6 on RHEL/CentOS 7/6 &amp; Fedora 20-24</a> </p>
<h2 id="最终搭建的环境"><a href="#最终搭建的环境" class="headerlink" title="最终搭建的环境"></a>最终搭建的环境</h2><ul>
<li>CentOS : 7.2</li>
<li>Nginx : 1.10.1</li>
<li>Mariadb : 5.5</li>
<li>PHP : 5.6</li>
</ul>
<h2 id="安装-epel-和-remi-源"><a href="#安装-epel-和-remi-源" class="headerlink" title="安装 epel 和 remi 源"></a>安装 epel 和 remi 源</h2><p>方便后面安装 php 。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm</div></pre></td></tr></table></figure>
<h2 id="安装-Nginx"><a href="#安装-Nginx" class="headerlink" title="安装 Nginx"></a>安装 Nginx</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install nginx</div></pre></td></tr></table></figure>
<h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">nginx</div><div class="line"><span class="comment"># 或者</span></div><div class="line">systemctl start nginx</div></pre></td></tr></table></figure>
<p>启动成功后，在浏览器中输入服务器地址可以看到 Welcome to nginx 界面。<br>PS：若服务器已有 apache，可能会导致使用 80 端口冲突，可关闭 apache 的 httpd 服务或者修改 nginx 的默认端口配置。</p>
<h3 id="修改-nginx-默认使用的端口（建议）"><a href="#修改-nginx-默认使用的端口（建议）" class="headerlink" title="修改 nginx 默认使用的端口（建议）"></a>修改 nginx 默认使用的端口（建议）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">vi /etc/nginx/nginx.conf</div><div class="line"><span class="comment"># TODO： 修改监听的端口（如下图，将监听的端口改为 8089）</span></div></pre></td></tr></table></figure>
<p><img src="http://7xsi11.com1.z0.glb.clouddn.com/modify-nginx-port.png" alt=""> </p>
<p>重启 nginx 后，可以查看到 nginx 使用的端口是 8089 。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">nginx <span class="_">-s</span> stop</div><div class="line">nginx</div><div class="line">netstat -tnl | grep 80</div><div class="line"><span class="comment"># 输出</span></div><div class="line">tcp        0      0 0.0.0.0:8089            0.0.0.0:*               LISTEN</div><div class="line">tcp6       0      0 :::8089                 :::*                    LISTEN</div></pre></td></tr></table></figure></p>
<h2 id="安装-Mysql"><a href="#安装-Mysql" class="headerlink" title="安装 Mysql"></a>安装 Mysql</h2><h3 id="安装-mariadb"><a href="#安装-mariadb" class="headerlink" title="安装 mariadb"></a>安装 mariadb</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install mariadb mariadb-server</div></pre></td></tr></table></figure>
<h3 id="启动-1"><a href="#启动-1" class="headerlink" title="启动"></a>启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl start mariadb</div></pre></td></tr></table></figure>
<h3 id="设-root-密码"><a href="#设-root-密码" class="headerlink" title="设 root 密码"></a>设 root 密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql_secure_installation</div><div class="line"><span class="comment"># TODO : 根据提示完成密码设置</span></div></pre></td></tr></table></figure>
<h3 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -uroot -p</div></pre></td></tr></table></figure>
<h2 id="安装-PHP"><a href="#安装-PHP" class="headerlink" title="安装 PHP"></a>安装 PHP</h2><h3 id="修改-remi-配置"><a href="#修改-remi-配置" class="headerlink" title="修改 remi 配置"></a>修改 remi 配置</h3><p>由于 remi 仓库默认提供 PHP 5.4 版本，安装其它版本需要修改配置。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vi /etc/yum.repos.d/remi.repo</div></pre></td></tr></table></figure></p>
<p>将 [remi-php56] 的 enabled=0 改成 enabled=1 。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[remi-php56]</div><div class="line">name=Remi<span class="string">'s PHP 5.6 RPM repository for Enterprise Linux 7 - $basearch</span></div><div class="line">#baseurl=http://rpms.remirepo.net/enterprise/7/php56/$basearch/</div><div class="line">mirrorlist=http://rpms.remirepo.net/enterprise/7/php56/mirror</div><div class="line"># NOTICE: common dependencies are in "remi-safe"</div><div class="line">enabled=1</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</div></pre></td></tr></table></figure></p>
<h3 id="安装-php-amp-amp-php-fpm"><a href="#安装-php-amp-amp-php-fpm" class="headerlink" title="安装 php &amp;&amp; php-fpm"></a>安装 php &amp;&amp; php-fpm</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install php php-common php-fpm</div></pre></td></tr></table></figure>
<h3 id="安装-php-modules"><a href="#安装-php-modules" class="headerlink" title="安装 php modules"></a>安装 php modules</h3><p>根据需要安装，或者以后用到再装。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum --enablerepo=remi install php-mysql php-pgsql php-pecl-mongo php-pecl-memcache php-pecl-memcached php-gd php-mbstring php-mcrypt php-xml php-pecl-apc php-cli php-pear php-pdo</div></pre></td></tr></table></figure></p>
<h2 id="Nginx-MariaDB-and-PHP-FPM-服务启动"><a href="#Nginx-MariaDB-and-PHP-FPM-服务启动" class="headerlink" title="Nginx, MariaDB and PHP-FPM 服务启动"></a>Nginx, MariaDB and PHP-FPM 服务启动</h2><h3 id="开机自启"><a href="#开机自启" class="headerlink" title="开机自启"></a>开机自启</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">systemctl <span class="built_in">enable</span> nginx</div><div class="line">syatemctl <span class="built_in">enable</span> mariadb</div><div class="line">systemctl <span class="built_in">enable</span> php-fpm</div></pre></td></tr></table></figure>
<h3 id="命令启动"><a href="#命令启动" class="headerlink" title="命令启动"></a>命令启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">systemctl start nginx</div><div class="line">systemctl start nginx</div><div class="line">systemctl start nginx</div></pre></td></tr></table></figure>
<h2 id="让-Nginx-支持-PHP-FPM"><a href="#让-Nginx-支持-PHP-FPM" class="headerlink" title="让 Nginx 支持 PHP-FPM"></a>让 Nginx 支持 PHP-FPM</h2><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>PS : 这里的配置只针对 nginx 的默认 server 站点，具体项目需要另外配置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span>  /etc/nginx</div><div class="line">vi nginx.conf</div></pre></td></tr></table></figure>
<p>在 http{server{}} 中写入<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">index index.php index.html index.htm;</div><div class="line"></div><div class="line">location ~ \.php$ &#123;</div><div class="line">        try_files <span class="variable">$uri</span> =404;</div><div class="line">        fastcgi_split_path_info ^(.+\.php)(/.+)$;</div><div class="line">        fastcgi_pass 127.0.0.1:9000;</div><div class="line">        fastcgi_index index.php;</div><div class="line">        fastcgi_param SCRIPT_FILENAME <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</div><div class="line">        include fastcgi_params;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这里的 fastcgi_pass 配置比较关键，不同服务器的 php-fpm 版本好像有不一样写法（坑：好像有 php-fpm 和 php5-fpm 的区别）。可以查看 /etc/php-fpm.d/www.conf 文件中的 listen 字段，如果 listen = 127.0.0.1:9000 就是上述配置。配置错误会出现访问 php 文件，变成下载，意味着 nginx 不能将访问 php 的请求转给 php-fpm 处理，具体解答可看<br><a href="http://stackoverflow.com/questions/25591040/nginx-serves-php-files-as-downloads-instead-of-executing-them" target="_blank" rel="external">Nginx serves .php files as downloads, instead of executing them</a> </p>
<p>修改后的 server 块，大致如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">        listen       8089 default_server;</div><div class="line">        listen       [::]:8089 default_server;</div><div class="line">        server_name  _;</div><div class="line">        root         /usr/share/nginx/html;</div><div class="line">        index index.php index.html index.htm;</div><div class="line"></div><div class="line">        location ~ \.php$ &#123;</div><div class="line">            try_files <span class="variable">$uri</span> =404;</div><div class="line">            fastcgi_split_path_info ^(.+\.php)(/.+)$;</div><div class="line">            fastcgi_pass 127.0.0.1:9000;</div><div class="line">            fastcgi_index index.php;</div><div class="line">            fastcgi_param SCRIPT_FILENAME <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</div><div class="line">            include fastcgi_params;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment"># Load configuration files for the default server block.</span></div><div class="line">        include /etc/nginx/default.d/*.conf;</div><div class="line"></div><div class="line">        location / &#123;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        error_page 404 /404.html;</div><div class="line">            location = /40x.html &#123;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        error_page 500 502 503 504 /50x.html;</div><div class="line">            location = /50x.html &#123;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>测试配置是否正确<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">nginx -t</div><div class="line"><span class="comment"># 输出</span></div><div class="line">nginx: the configuration file /etc/nginx/nginx.conf syntax is ok</div><div class="line">nginx: configuration file /etc/nginx/nginx.conf <span class="built_in">test</span> is successful</div></pre></td></tr></table></figure></p>
<h3 id="修改-php-fpm-的运行用户"><a href="#修改-php-fpm-的运行用户" class="headerlink" title="修改 php-fpm 的运行用户"></a>修改 php-fpm 的运行用户</h3><p>PS: 网上一般推荐将 nginx 和 php-fpm 的运行用户都设为 nobody 。但这里暂时不详细设置用户权限，之后再研究，这里直接将 php-fpm 的运行用户改为 nginx 。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vi /etc/php-fpm.d/www.conf</div></pre></td></tr></table></figure></p>
<p>在如下位置将 apache 修改为 nginx 。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">; Unix user/group of processes</div><div class="line">; Note: The user is mandatory. If the group is not <span class="built_in">set</span>, the default user<span class="string">'s group</span></div><div class="line">;       will be used.</div><div class="line">; RPM: apache Choosed to be able to access some dir as httpd</div><div class="line">user = nginx</div><div class="line">; RPM: Keep a group allowed to write in log dir.</div><div class="line">group = nginx</div></pre></td></tr></table></figure></p>
<p>重启 php-fpm<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl restart php-fpm</div></pre></td></tr></table></figure></p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>在 nginx 的默认 server 项目中添加 index.php 。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vi /usr/share/nginx/html/index.php</div></pre></td></tr></table></figure></p>
<p>写入<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">phpinfo();</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>在浏览器中访问 <a href="http://host/index.php" target="_blank" rel="external">http://host/index.php</a> ，能正确输出 php 信息，则表示配置成功，可以在 nginx 服务器里运行 php 项目了。</p>
<p>PS: 测试不成功，可以先清除浏览器缓存再试，再不成功再找配置问题。</p>
<p>测试完，删除测试的 index.php 文件，避免泄漏服务器上的信息。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-10-27T04:56:15.000Z"><a href="/2016/10/27/auto-deploy-projects/">2016-10-27</a></time>
      
      
  
    <h1 class="title"><a href="/2016/10/27/auto-deploy-projects/">用 GIT-HOOKS 自动化部署项目</a></h1>
  

    </header>
    <div class="entry">
      
        <p>注：本实践过程基于 centos 服务器<br>参考：<a href="https://segmentfault.com/a/1190000003836345" target="_blank" rel="external">用 Git Hooks 进行自动部署</a> </p>
<h2 id="实现目标"><a href="#实现目标" class="headerlink" title="实现目标"></a>实现目标</h2><p>本地 push 代码到 git 服务器的中央仓库，中央仓库自动部署代码到项目的运行目录。</p>
<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><h3 id="搭建-GIT-服务器"><a href="#搭建-GIT-服务器" class="headerlink" title="搭建 GIT 服务器"></a><a href="http://jiajieshen.github.io/2016/10/25/build-git-server/">搭建 GIT 服务器</a></h3><p>此时，服务器里已经搭建了一个中央仓库 helloworld.git。</p>
<p>注：中央仓库只是一个裸仓库，不包含任何的项目工作文件，只相当于普通 git 项目里隐藏的 .git 目录。</p>
<p>假设项目部署在 /opt/www/ 目录下，克隆中央仓库到此目录。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">cd /opt</div><div class="line">mkdir www</div><div class="line">chown -R git:git www/ # 授权</div><div class="line">cd www</div><div class="line">git clone file:///opt/git/helloworld.git # clone 中央仓库</div><div class="line">chown -R git:git helloworld # 授权给 git 用户</div></pre></td></tr></table></figure></p>
<h2 id="编写-hook"><a href="#编写-hook" class="headerlink" title="编写 hook"></a>编写 hook</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># 进入中央仓库的 hooks 目录</div><div class="line">cd /opt/git/helloworld.git/hooks/</div><div class="line"># post-receive 脚本会在客户端 push 代码完成之后调用; </div><div class="line"># 其它应用场景可看详细的官方文档或同目录下的 .sample 文件。</div><div class="line">vi post-receive</div><div class="line"># TODO: 编写脚本</div><div class="line"></div><div class="line">chown git:git post-receive # 授权给 git 用户</div><div class="line">chmod +x post-receive # 添加可运行权限</div></pre></td></tr></table></figure>
<p>脚本如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"></div><div class="line">unset GIT_DIR</div><div class="line"></div><div class="line">NowPath=`pwd`</div><div class="line">DeployPath=&quot;/opt/www/helloworld&quot; # 应用部署目录</div><div class="line"></div><div class="line">cd $DeployPath</div><div class="line">git pull # 确保 git 用户有读写的权限</div><div class="line"></div><div class="line">cd $NowPath</div><div class="line"></div><div class="line">exit 0</div></pre></td></tr></table></figure></p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>git 客户端用户 push 代码更新到中央仓库，可以发现服务器上部署的项目跟着更新。</p>
<p>测试成功的输出大致如下：</p>
<p><img src="http://7xsi11.com1.z0.glb.clouddn.com/after-auto-deploy.png" alt=""> </p>
<h2 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h2><ul>
<li>了解 git 服务支持的 hooks</li>
<li>根据客户端 push 不同分支，服务器自动部署到不同的项目环境</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-10-25T03:23:19.000Z"><a href="/2016/10/25/build-git-server/">2016-10-25</a></time>
      
      
  
    <h1 class="title"><a href="/2016/10/25/build-git-server/">搭建私有 GIT 服务器</a></h1>
  

    </header>
    <div class="entry">
      
        <p>注：实践过程基于 centos 服务器<br>参考：<a href="http://www.tangshuang.net/1693.html" target="_blank" rel="external">在阿里云上搭建自己的 git 服务器</a> </p>
<h2 id="服务器安装-git"><a href="#服务器安装-git" class="headerlink" title="服务器安装 git"></a>服务器安装 git</h2><h3 id="安装-git"><a href="#安装-git" class="headerlink" title="安装 git"></a>安装 git</h3><p>与本地电脑安装 git 一样，无需其它步骤。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install git</div></pre></td></tr></table></figure></p>
<h3 id="添加-git-用户"><a href="#添加-git-用户" class="headerlink" title="添加 git 用户"></a>添加 git 用户</h3><p>出于安全考虑，在服务器创建一个用户 git（命名随意），该用户登录服务器后只允许运行 git 命令。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adduser git</div></pre></td></tr></table></figure></p>
<h3 id="禁止用户-git-通过-ssh-连接服务器控制台"><a href="#禁止用户-git-通过-ssh-连接服务器控制台" class="headerlink" title="禁止用户 git 通过 ssh 连接服务器控制台"></a>禁止用户 git 通过 ssh 连接服务器控制台</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vi /etc/passwd</div></pre></td></tr></table></figure>
<p>TODO: 将 git 用户登录后运行的 shell 程序，由 /bin/bash 指定为 /usr/bin/git-shell</p>
<h3 id="修改用户-git-的密码"><a href="#修改用户-git-的密码" class="headerlink" title="修改用户 git 的密码"></a>修改用户 git 的密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">passwd git</div></pre></td></tr></table></figure>
<h2 id="本地与服务器建立-ssh-连接"><a href="#本地与服务器建立-ssh-连接" class="headerlink" title="本地与服务器建立 ssh 连接"></a>本地与服务器建立 ssh 连接</h2><p>建立 ssh 连接可以让本地的 git 与服务器上的 git 之间建立安全的加密连接，而不需要输入账号和密码。</p>
<h3 id="本地生成-ssh-密钥"><a href="#本地生成-ssh-密钥" class="headerlink" title="本地生成 ssh 密钥"></a>本地生成 ssh 密钥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -C 添加注释</span></div><div class="line"><span class="comment"># -f 文件名</span></div><div class="line">ssh-keygen -t rsa -C <span class="string">"xxx@xxx.com"</span> <span class="_">-f</span> xxx_rsa</div></pre></td></tr></table></figure>
<h3 id="查看生成的公钥"><a href="#查看生成的公钥" class="headerlink" title="查看生成的公钥"></a>查看生成的公钥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat ~/.ssh/id_rsa.pub</div></pre></td></tr></table></figure>
<h3 id="将公钥上传服务器"><a href="#将公钥上传服务器" class="headerlink" title="将公钥上传服务器"></a>将公钥上传服务器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># user@host 替换为远程真正的用户和域名</span></div><div class="line">ssh-copy-id user@host</div></pre></td></tr></table></figure>
<p>或<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 在服务器上手动添加</span></div><div class="line"><span class="built_in">cd</span> /home/git/</div><div class="line">mkdir .ssh</div><div class="line"><span class="built_in">cd</span> .ssh</div><div class="line">vi authorized_keys</div><div class="line"><span class="comment"># <span class="doctag">TODO:</span> 粘贴本地用户的公钥（每行一条公钥）</span></div></pre></td></tr></table></figure></p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="git-服务器创建中央仓库"><a href="#git-服务器创建中央仓库" class="headerlink" title="git 服务器创建中央仓库"></a>git 服务器创建中央仓库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 目录随意</span></div><div class="line"><span class="built_in">cd</span> /opt</div><div class="line">mkdir git</div><div class="line">chown -R git:git git</div><div class="line"><span class="built_in">cd</span> git</div><div class="line"></div><div class="line"><span class="comment"># 创建裸仓库 helloworld.git，其中以 .git 结尾是惯例。</span></div><div class="line">git init --bare helloworld.git</div><div class="line"><span class="comment"># 授权</span></div><div class="line">chown -R git:git helloworld.git/</div></pre></td></tr></table></figure>
<h4 id="git-init-与-git-init-–bare-的区别"><a href="#git-init-与-git-init-–bare-的区别" class="headerlink" title="git init 与 git init –bare 的区别"></a><a href="https://segmentfault.com/q/1010000004683286" target="_blank" rel="external">git init 与 git init –bare 的区别</a></h4><h3 id="本地-git-访问中央仓库"><a href="#本地-git-访问中央仓库" class="headerlink" title="本地 git 访问中央仓库"></a>本地 git 访问中央仓库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># host 替换为服务器域名</span></div><div class="line">git <span class="built_in">clone</span> git@host:/opt/git/helloworld.git</div><div class="line"><span class="comment"># <span class="doctag">TODO:</span> 输入用户 git 密码</span></div><div class="line"><span class="comment"># 返回输出：</span></div><div class="line"><span class="comment"># warning: You appear to have cloned an empty repository.</span></div><div class="line"><span class="comment"># Checking connectivity... done.</span></div><div class="line"></div><div class="line"><span class="comment"># test</span></div><div class="line"><span class="built_in">cd</span> helloworld</div><div class="line">touch hello.md</div><div class="line">git add hello.md</div><div class="line">git commit -m <span class="string">"test"</span></div><div class="line">git push origin master:master</div></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-10-22T11:37:44.806Z"><a href="/2016/10/22/hello-world/">2016-10-22</a></time>
      
      
  
    <h1 class="title"><a href="/2016/10/22/hello-world/">Hello World</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





<nav id="pagination">
  
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:jiajieshen.github.io">
  </form>
</div>

  

  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/Intellij-IDEA/">Intellij IDEA</a><small>1</small></li>
  
    <li><a href="/tags/git/">git</a><small>3</small></li>
  
    <li><a href="/tags/kotlin/">kotlin</a><small>1</small></li>
  
    <li><a href="/tags/php/">php</a><small>2</small></li>
  
    <li><a href="/tags/plugin/">plugin</a><small>1</small></li>
  
    <li><a href="/tags/服务器/">服务器</a><small>2</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2017 fbsum
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
</html>


<a href="https://github.com/fbsum" target="_blank"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_white_ffffff.png" alt="Fork me on GitHub"></a>
